{"version":3,"sources":["hookInvoke.js"],"names":["hookInvoke","obj","onCalling","onCalled","Proxy","get","target","propKey","origMethod","args","Promise","resolve","name","returned","apply","then","catch"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,UAAU,GAAG,CAACC,GAAD,EAAMC,SAAN,EAAiBC,QAAjB,KACf,IAAIC,KAAJ,CAAUH,GAAV,EAAe;AACXI,EAAAA,GAAG,CAACC,MAAD,EAASC;AAAQ;AAAjB,IAAiC;AAChC,UAAMC,UAAU,GAAGF,MAAM,CAACC,OAAD,CAAzB;;AACA,QAAI,OAAOC,UAAP,KAAsB,UAA1B,EAAsC;AAClC,aAAO,YAAmB;AAAA,0CAANC,IAAM;AAANA,UAAAA,IAAM;AAAA;;AACtBP,QAAAA,SAAS,IAAIQ,OAAO,CAACC,OAAR,CAAgBT,SAAS,CAACD,GAAD,EAAM;AAAEW,UAAAA,IAAI,EAAEL,OAAR;AAAiBE,UAAAA;AAAjB,SAAN,CAAzB,CAAb;AACA,YAAII,QAAQ,GAAGL,UAAU,CAACM,KAAX,CAAiBR,MAAjB,EAAyBG,IAAzB,CAAf;AACAN,QAAAA,QAAQ,IACJO,OAAO,CAACC,OAAR,CAAgBE,QAAhB,EACKE,IADL,CACWF,QAAD,IAAcH,OAAO,CAACC,OAAR,CAAgBR,QAAQ,CAACF,GAAD,EAAM;AAAEW,UAAAA,IAAI,EAAEL,OAAR;AAAiBM,UAAAA;AAAjB,SAAN,CAAxB,CADxB,EAEKG,KAFL,EADJ;AAIA,eAAOH,QAAP;AACH,OARD;AASH;;AAED,WAAOL,UAAP;AACH;;AAhBU,CAAf,CADJ;;AAoBA,eAAeR,UAAf","sourcesContent":["/**\n * Add hooks before an object's method is being called and after.\n * @alias lang.hookInvoke\n * @param {*} obj\n * @param {*} onCalling - Before hook\n * @param {*} onCalled - After hook\n * @returns {Object} The hooked object\n */\nconst hookInvoke = (obj, onCalling, onCalled) =>\n    new Proxy(obj, {\n        get(target, propKey /*, receiver*/) {\n            const origMethod = target[propKey];\n            if (typeof origMethod === 'function') {\n                return function (...args) {\n                    onCalling && Promise.resolve(onCalling(obj, { name: propKey, args }));\n                    let returned = origMethod.apply(target, args);\n                    onCalled &&\n                        Promise.resolve(returned)\n                            .then((returned) => Promise.resolve(onCalled(obj, { name: propKey, returned })))\n                            .catch();\n                    return returned;\n                };\n            }\n\n            return origMethod;\n        },\n    });\n\nexport default hookInvoke;\n"]}