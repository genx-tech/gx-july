{"version":3,"sources":["url.js"],"names":["join","base","extraPath","more","length","reduce","result","part","appendQuery","url","query","posQM","indexOf","objectToQueryString","split","qs","previousObj","queryStringToObject","newObj","newQs","substr","parts","r","pair","k","v","decodeURIComponent","obj","encodeURIComponent","push"],"mappings":"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","sourcesContent":["import { dropIfEndsWith, ensureStartsWith } from './text';\n\n/**\n * Join base url and the extra url path.\n * @function module:url.join\n * @param {string} base\n * @param {string} extraPath\n * @returns {string}\n */\nexport function join(base, extraPath, ...more) {\n    if (more && more.length > 0) {\n        return more.reduce((result, part) => join(result, part), join(base, extraPath));\n    } \n\n    return base\n        ? extraPath\n            ? dropIfEndsWith(base, '/') + ensureStartsWith(extraPath, '/')\n            : base\n        : extraPath;\n}\n\n/**\n * Merge the query parameters into given url.\n * @function module:url.appendQuery\n * @param {string} url - Original url.\n * @param {object} query - Key-value pairs query object to be merged into the url.\n * @returns {string}\n */\nexport function appendQuery(url, query) {\n    if (!query) return url;\n\n    const posQM = url.indexOf('?');\n\n    if (posQM === -1) {\n        if (typeof query !== 'string') {\n            query = objectToQueryString(query);\n        }\n\n        return query ? url + '?' + query : url;\n    }\n\n    const [base, qs] = url.split('?', 2);\n    const previousObj = queryStringToObject(qs);\n    const newObj =\n        typeof query === 'string' ? queryStringToObject(query) : query;\n\n    const newQs = objectToQueryString({ ...previousObj, ...newObj });\n\n    return newQs ? base + '?' + newQs : url;\n}\n\n/**\n * Parse query string into key-value pairs.\n * @function module:url.queryStringToObject\n * @param {string} qs\n * @returns {object}\n */\nexport function queryStringToObject(qs) {\n    if (!qs) {\n        return {};\n    }\n    const query = qs[0] === '?' ? qs.substr(1) : qs;\n    const parts = query.split('&');\n\n    return parts.reduce((r, pair) => {\n        const [k, v] = pair.split('=');\n        r[decodeURIComponent(k)] = v == null ? null : decodeURIComponent(v);\n        return r;\n    }, {});\n}\n\n/**\n * Stringify an object into url query string.\n * @function module:url.objectToQueryString\n * @param {*} obj\n * @returns {string}\n */\nexport function objectToQueryString(obj) {\n    let parts = [];\n\n    for (let k in obj) {\n        const v = obj[k];\n        const part =\n            v == null\n                ? encodeURIComponent(k)\n                : `${encodeURIComponent(k)}=${encodeURIComponent(v)}`;\n        parts.push(part);\n    }\n\n    return parts.join('&');\n}\n"]}